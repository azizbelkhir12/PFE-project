<app-navbarcompte-admin></app-navbarcompte-admin>
<app-sidebar-admin></app-sidebar-admin>

<div class="main-container">
  <!-- ✅ Statistiques -->
  <div class="stats-container">
    <div class="stats-card">
      <i class="fas fa-newspaper icon-yellow"></i>
      <h4>Articles publiés</h4>
      <p>{{ totalArticlesPublies }}</p>
    </div>
    <div class="stats-card">
      <i class="fas fa-file-alt icon-yellow"></i>
      <h4>Articles non publiés</h4>
      <p>{{ totalArticlesNonPublies }}</p>
    </div>
    <div class="stats-card">
      <i class="fas fa-calendar-day icon-yellow"></i>
      <h4>Articles récents</h4>
      <p>{{ totalArticlesRecents }}</p>
    </div>
  </div>

  <!-- ✅ Boutons de sélection -->
  <div class="form-toggle-container">
    <button class="btn-toggle" (click)="afficherFormulaire('ajout')">Ajouter un article</button>
    <button class="btn-toggle" (click)="afficherFormulaire('liste')">Voir les articles</button>
  </div>

  <!-- ✅ Barre de recherche -->
  <div class="search-container" *ngIf="formulaireActif === 'liste'">
    <div class="search-field">
      <input type="text" id="searchTitle" [(ngModel)]="rechercheTitre" placeholder="Rechercher par titre">
    </div>
    <div class="search-field">
      <input type="date" id="searchDate" [(ngModel)]="rechercheDate" placeholder="Rechercher par date">
    </div>
    <div class="search-field">
      <select id="searchStatus" [(ngModel)]="rechercheStatut">
        <option value="">Tous les statuts</option>
        <option value="publie">Publié</option>
        <option value="brouillon">Non publié</option>
      </select>
    </div>
  </div>

  <!-- ✅ Formulaire d’ajout d’article -->
  <div class="forms-container" *ngIf="formulaireActif === 'ajout'">
    <div class="form-card">
      <h3>Ajout d’un article</h3>
      <form (ngSubmit)="soumettreArticle()" #articleForm="ngForm">
        <label for="titre">Titre</label>
        <input type="text" id="titre" [(ngModel)]="nouvelArticle.titre" name="titre" required>

        <label for="contenu">Contenu</label>
        <textarea id="contenu" [(ngModel)]="nouvelArticle.contenu" name="contenu" rows="10" required></textarea>

        <label for="date">Date de publication</label>
        <input type="date" id="date" [(ngModel)]="nouvelArticle.datePublication" name="date" required>

        <label for="image">Image</label>
        <input type="file" id="image" (change)="onImageSelected($event)" accept="image/*">

        <button type="submit" class="btn btn-jaune" [disabled]="!articleForm.form.valid">Ajouter</button>
      </form>
    </div>
  </div>

  <!-- ✅ Liste des articles avec actions -->
  <div class="row justify-content-center" *ngIf="formulaireActif === 'liste'">
    <div class="card-article" *ngFor="let article of getArticlesFiltres()">
      <img [src]="article.image" alt="Image article">
      <h5>{{ article.titre }}</h5>
      <p [innerHTML]="article.contenu | slice:0:150"></p>
      <div class="date">Publié le : {{ article.datePublication | date:'dd/MM/yyyy' }}</div>

      <div class="actions">
        <button class="btn btn-modifier" (click)="modifierArticle(article)">Modifier</button>
        <button class="btn btn-supprimer" (click)="supprimerArticle(article)">Supprimer</button>
        <button class="btn btn-publier" *ngIf="!article.publie" (click)="publierArticle(article)">Publier</button>
      </div>
    </div>
  </div>
</div>
